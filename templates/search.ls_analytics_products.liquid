{% layout none %}{% assign ls_default_lang = shop.metafields.langshop['lang_default'] %}{% assign ls_langs_meta = shop.metafields.langshop["lang_list"] %}{% assign ls_lags_str = "" %}{% if ls_langs_meta != blank and ls_default_lang != blank %}{% assign ls_split = ls_langs_meta | split: '"lang_id":"' %}{% for lang_str in ls_split offset:1 %}{% assign ls_lang = lang_str | split: '","lang_title"' | first %}{% if ls_lang != ls_default_lang %}{% assign ls_lags_str = ls_lags_str | append: "," | append: ls_lang %}{% endif %}{% endfor %}{% assign ls_lags = ls_lags_str | remove_first: "," | split: "," %}{% endif %}{ "products": [ {%- paginate collections.all.products by 1000 -%}{%- for product in collections.all.products -%} { "id" : {{ product.id }}, "handle" : {{ product.handle | json }}, "title" : {{ product.title | json }}, {% if product.featured_image %} "image": { "src": {{ product.featured_image | json }} }, {% endif %} "published_at"	: {{ product.published_at | date: "%Y-%m-%d %H:%M:%S" | json }}, "created_at"	: {{ product.created_at | date: "%Y-%m-%d %H:%M:%S" | json }}, "vendor" : {{ product.vendor | json }}, "type" : {{ product.type | json }}, "translations"	: { {% for lang in ls_lags %} "{{ lang }}": { {% capture key_meta_title %}{{lang}}_title{% endcapture %}{% assign title = product.metafields.langshop[key_meta_title] | strip %} "title": {% if title != blank %}true{% else %}false{% endif %}, {% capture key_meta_content %}{{lang}}_body_html{% endcapture %}{% assign content = product.metafields.langshop[key_meta_content] | strip %} "content": {% if product.description != blank and content == blank %}false{% else %}true{% endif %}, {% assign variants_translated = "true" %}{% assign options_translated = "true" %}{% unless product.options.size == 1 and product.variants[0].title == 'Default Title' %}{% for option in product.options_with_values %}{% capture product_option %}{{lang}}_option{{forloop.index}}{% endcapture %}{% if product.metafields.langshop[product_option] == blank %}{% assign options_translated = "false" %}{% endif %}{% break %}{% endfor %}{% for variant in product.variants %}{% for option in product.options_with_values %}{% capture variant_option %}{{lang}}_variant_option{{forloop.index}}{% endcapture %}{% if variant.metafields.langshop[variant_option] == blank %}{% assign variants_translated = "false" %}{% endif %}{% break %}{% endfor %}{% if variants_translated == "false" %}{% break %}{% endif %}{% endfor %}{% endunless %} "variants": {{ variants_translated }}, "options": {{ options_translated }} }{% if forloop.last == false %},{% endif %}{% endfor %} } }{% if forloop.last == false %},{% endif %}{%- endfor -%}{%- endpaginate -%}] }